# VLANタギングを物理ネットワークに適用

IncusOSは設定されたインターフェースまたはボンドに対して1つ以上のVLANに自動のVLANタギングを割り当てられます。

このチュートリアルではネットワークインターフェースは`enp5s0`という名前であり、設定したいVLAN IDは`1234`であるということにします。

VLANタギングを割り当てるには、インターフェースが`instances` [role](../reference/system/network.md)と希望するVLAN IDの一覧からなる`vlan_tags`プロパティーの両方を持つ必要があります。これは`incus admin os system network edit`を実行して以下のように設定を編集することで実現できます：

```
config:
  interfaces:
  - addresses:
    - dhcp4
    - slaac
    hwaddr: 10:66:6a:d2:32:18
    lldp: false
    name: enp5s0
    required_for_online: "no"
    roles:
    - instances
    vlan_tags:
    - 1234
```

設定の変更を反映したら、アンマネージドのブリッジが現れます：

```
gibmat@futurfusion:~$ incus network list
+----------+--------+---------+-----------------+---------------------------+----------------------------+---------+---------+
|   NAME   |  TYPE  | MANAGED |      IPV4       |           IPV6            |        DESCRIPTION         | USED BY |  STATE  |
+----------+--------+---------+-----------------+---------------------------+----------------------------+---------+---------+
| enp5s0   | bridge | NO      |                 |                           |                            | 0       |         |
+----------+--------+---------+-----------------+---------------------------+----------------------------+---------+---------+
| incusbr0 | bridge | YES     | 10.148.244.1/24 | fd42:15d0:aec3:c78d::1/64 | Local network bridge (NAT) | 1       | CREATED |
+----------+--------+---------+-----------------+---------------------------+----------------------------+---------+---------+

```

VLAN `1234`のマネージドネットワークを作成します：

```
gibmat@futurfusion:~$ incus network create enp5s0.1234 parent=enp5s0 vlan=1234 --type=physical
Network enp5s0.1234 created
gibmat@futurfusion:~$ incus network list
+-------------+----------+---------+-----------------+---------------------------+----------------------------+---------+---------+
|    NAME     |   TYPE   | MANAGED |      IPV4       |           IPV6            |        DESCRIPTION         | USED BY |  STATE  |
+-------------+----------+---------+-----------------+---------------------------+----------------------------+---------+---------+
| enp5s0      | bridge   | NO      |                 |                           |                            | 1       |         |
+-------------+----------+---------+-----------------+---------------------------+----------------------------+---------+---------+
| enp5s0.1234 | physical | YES     |                 |                           |                            | 0       | CREATED |
+-------------+----------+---------+-----------------+---------------------------+----------------------------+---------+---------+
| incusbr0    | bridge   | YES     | 10.148.244.1/24 | fd42:15d0:aec3:c78d::1/64 | Local network bridge (NAT) | 1       | CREATED |
+-------------+----------+---------+-----------------+---------------------------+----------------------------+---------+---------+
```

これでインスタンスがVLAN `1234`を使うように設定できます：

```
gibmat@futurfusion:~$ incus launch images:debian/13 debian --network enp5s0.1234
Launching debian
gibmat@futurfusion:~$ incus list
+--------+---------+-----------------------+------------------------------------------------+-----------+-----------+
|  NAME  |  STATE  |         IPV4          |                      IPV6                      |   TYPE    | SNAPSHOTS |
+--------+---------+-----------------------+------------------------------------------------+-----------+-----------+
| debian | RUNNING | 10.234.136.199 (eth0) | fd42:3cfb:8972:3990:1266:6aff:fe71:14e0 (eth0) | CONTAINER | 0         |
+--------+---------+-----------------------+------------------------------------------------+-----------+-----------+
```

このネットワークをすべてのインスタンスのデフォルトにすることもできます：

```
gibmat@futurfusion:~$ incus profile device set default eth0 network=enp5s0.1234
```
