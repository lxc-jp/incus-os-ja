# 更新

IncusOSは毎回の起動時とそれ以降はデフォルトで6時間おきに設定された[プロバイダー](providers.md)で安定版の更新をチェックします。更新が利用可能な場合、IncusOSはそれをダウンロードし、アプリケーションを更新／再起動し、OSの更新を次回の起動時にスケジュールします。時々セキュアブブート鍵の更新も発行されますが、ほかの利用可能な更新の前に自動的に反映されます。

stableチャンネルの更新はLinuxカーネルや重要なセキュリティーの問題の最新の安定版のバグフィクスリリースを含む更新が通常は週に一回あります。一方testingチャンネルは新しい機能の開発に応じてより頻繁は更新が行われます。一般的にはstableチャンネルを使い続けることを推奨します。

OSの更新がインストールされる際、IncusOSは更新の適用を完了するには再起動が必要であるとコンソールにメッセージを表示します。REST APIでアップデート情報を問い合わせた際にもこれを報告します。

## 設定オプション

設定フィールドは[`SystemUpdateConfig`構造体](https://github.com/lxc/incus-os/blob/main/incus-osd/api/system_update.go)で定義されています。

以下の設定オプションが設定できます：

* `auto_reboot`: `true`の場合、IncusOSは更新を適用後、自動で再起動します。これにより再起動中にそのサーバー上で稼働しているアプリケーションは少しの期間サービスが中断することにご注意ください。（システムの起動中に更新を適用する場合はIncusOSは常に自動で再起動します。）

* `channel`: `stable`か`testing`のいずれか。

* `check_frequency`: Goの`time.ParseDuration()`でパースできる文字列あるいは`never`という特殊値。IncusOSが更新をチェックする際に使う頻度を制御します。`never`に設定すると自動更新を無効化します。システムがセキュリティーの更新を受け取るのに手動の更新チェックに依存することになるので、これは通常は避けてください。

* `maintenance_windows`: オプショナルのメンテナンスウィンドウのリスト。

## メンテナンスウィンドウ

IncusOSはシステムが更新をチェックし適用する時間帯を制限するメンテナンスウィンドウを定義することをサポートしています。これは通常の営業時間や他の不便な時間帯に更新がインストールされるのを回避するのに役立ちます。各メンテナンスウィンドウは（システムで設定されたタイムゾーンでの）開始時間と終了時間から構成され、オプショナルで週の開始日と週の終了日を持ちます：

### 例

毎日10pm～6amの間に更新を許可する：

```
{
  "config": {
    "maintenance_windows": [
      {
        "start_hour": 22,
        "start_minute": 0,
        "end_hour": 6,
        "end_minute": 0
      }
    ]
  }
}
```

週末にのみ更新を許可する：

```
{
  "config": {
    "maintenance_windows": [
      {
        "start_day_of_week": "Saturday",
        "start_hour": 0,
        "start_minute": 0,
        "end_day_of_week": "Sunday",
        "end_hour": 23,
        "end_minute": 59
      }
    ]
  }
}
```

## 更新を手動でチェック

任意の時点でIncusOSに更新をチェックするには以下のコマンドを実行します。

```
incus admin os system update check
```
